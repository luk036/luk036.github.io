<!doctype html>
<html>
  <head>
    <title>
      Lecture 05b - âŒš Clock Skew Scheduling Under Process Variations (2)
    </title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width"
    />
    <link rel="stylesheet" type="text/css" href="../katex/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/spaces.css" />
    <link rel="stylesheet" type="text/css" href="../css/slides.css" />
    <link rel="stylesheet" type="text/css" href="../css/nord-dark.css" />
    <link rel="stylesheet" type="text/css" href="../css/nord-light.css" />
    <link rel="stylesheet" type="text/css" href="../css/font-nord.css" />
    <link rel="stylesheet" type="text/css" href="../css/bg-nord.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
  </head>
  <body>
    <textarea id="source">

layout: true
class: typo, typo-selection

---

count: false
class: nord-dark, middle, center

Lecture 05b - âŒš Clock Skew Scheduling Under Process Variations (2)
================================================================

@luk036 ğŸ‘¨ğŸ»â€ğŸ«

2024-10-30 ğŸ“…

---

Overview ğŸ“‹
------

.pull-left[

-   A Review of CSS Issues

-   General Formulation

-   Yield-driven Clock Skew Scheduling

-   Numerical Results

]
.pull-right[

![image](figs/dfm.svg)

]

---

Minimum Clock Period Problem
----------------------------

-   Linear programming (LP) formulation $$\begin{array}{ll}
      \text{minimize}   & {\color{darkorange}T_\text{CP} } \\
      \text{subject to} & l_{ij} \leq {\color{red}t_i} - {\color{red}t_j} \leq u_{ij}
    \end{array}$$ where $\text{FF}_i$ and $\text{FF}_j$ are
    sequentially adjacent to each other.

-   The above constraints are called *system of difference
    constraints* (see Introduction to Algorithms, MIT):
    -   Key: it is easy to check if a feasible solution exists by detecting
        negative cycles using the Bellman-Ford algorithm.

---

System of Difference Constraints
--------------------------------

-   In some cases, you may need to do some transformations, e.g.
    -   ${\color{red}t_i} \leq \min_k \{{\color{red}t_k} + a_{ik}\} \rightarrow {\color{red}t_i} - {\color{red}t_k} \leq a_{ik}, \; \forall k$
    -   ${\color{red}t_i} \geq \max_k \{{\color{red}t_k} + b_{ik}\} \rightarrow b_{ik} \leq {\color{red}t_i} - {\color{red}t_k}, \; \forall k$

---

Slack Maximization (EVEN)
-------------------------

-   Slack Maximization Scheduling $$\begin{array}{ll}
      \text{maximum}    & {\color{darkorange}\beta} \\
      \text{subject to} & {\color{red}t_j} - {\color{red}t_i} \leq \mu_{ij} - {\color{darkorange}\beta}
    \end{array}$$ (ğŸ‘‰ Note: $\mu_{ij} \text{ is not equal to } \mu_{ji}$)

-   is equivalent to the so-called *minimum mean cycle problem* (MMC),
    where:
    -   ${\color{darkorange}\beta}^* = \sum_{(i,j) \in C} \mu_{ij} / |C|$,
    -   $C$: critical cycle (first negative cycle)

-   Can be efficiently solved by the parametric shortest path methods.

---

Slack Maximization (C-PROP)
---------------------------

-   Slack Maximization Scheduling $$\begin{array}{ll}
      \text{maximum}   & {\color{darkorange}\beta} \\
      \text{subject to} & {\color{red}t_j} - {\color{red}t_i} \leq \mu_{ij} - \sigma_{ij} {\color{darkorange}\beta}
    \end{array}$$ (we show the correctness later)

-   is equivalent to the *minimum cost-to-time ratio cycle problem* (MCR), where:
    -   ${\color{darkorange}\beta}^* = \sum_{(i,j) \in C} \mu_{ij} / \sum_{(i,j) \in C} \sigma_{ij}$,
    -   $C$: critical cycle

-   Assume Gaussian distribution (Bell Shape ğŸ””)

---

General Formulation
-------------------

$$\begin{array}{ll}
      \text{maximum}   & g(\beta) \\
      \text{subject to} & {\color{red}t_i} - {\color{red}t_j} \leq f_{ij}(\beta), \; \forall (i,j) \in E
    \end{array}$$
    
where $f_{ij}(\beta)$ a linear function that represents various problems defined above.

| Problem | $g(\beta)$ | $f_{ij}(\beta)$ (setup)                                 | $f_{ji}(\beta)$ (hold)                        |
| ------- | ------ | --------------------------------------------------- | ----------------------------------------- |
| Min CP | $-\beta$   | $\beta - D_{ij} - T_\text{s}$                       | $-T_\text{h} + d_{ij}$                 |
| EVEN    | $\beta$    | $T_\text{CP} - D_{ij} - T_\text{s} - \beta$         | $-T_\text{h} + d_{ij} - \beta$             |
| C-PROP  | $\beta$    | $T_\text{CP}-D_{ij}-T_\text{s} - \sigma_{ij} \beta$ | $-T_\text{h} + d_{ij} - \sigma_{ij} \beta$ |

---

General Formulation (cont'd)
----------------------------

-   In fact, $g(\beta)$ and $f_{ij}(\beta)$ are not necessarily linear functions.
    Any monotonic decreasing function will do.

-   Theorem: if $g(\beta)$ and $f_{ij}(\beta)$ are *monotonic decreasing*
    functions for all $i$ and $j$, then there is a unique solution to the problem.
    (prove later).

-   Question 1: Does this generalization have any application?

-   Question 2: What if $g(\beta)$ and $f_{ij}(\beta)$ are convex but not monotone?

---

Non-Gaussian Distribution 
-------------------------

.pull-left[

-   ~~65nm and below,~~ the path delay is likely to have a non-Gaussian distribution ğŸ”•:

    ğŸ‘‰ Note: central limit theorem does not apply here. Why?
]

.pull-right[

![image](figs/non-gaussian.png)

]

---

Timing Yield Maximization
-------------------------

-   Formulation:
    -   $\max\{\min\{\text{Pr}\{{\color{red}t_j} - {\color{red}t_i} \leq \tilde{W}_{ij} \}\}\}$
    -   is not exactly timing yield but reasonable.
    -   does not require correlation information among $\tilde{W}_{ij}$. Why?

-   It is equivalent to:

  $$\begin{array}{ll}
    \text{maximum} & {\color{darkorange}\beta} \\
    \text{subject to} & {\color{red}t_i} - {\color{red}t_j} \le T_\text{CP} - F^{-1}_{ji}({\color{darkorange}\beta}) \\
      & {\color{red}t_j} - {\color{red}t_i} \le F^{-1}_{ij}(1 - {\color{darkorange}\beta})
  \end{array}$$
    where $F_{ij}(\cdot) \text{ is CDF of } \tilde{W}_{ij}$

-   Luckily, any CDF must be a monotonic increasing function.

---

Statistical Interpretations of C-PROP
-------------------------------------

-   Reduce to C-PROP when $\tilde{W}_{ij}$ is Gaussian, or precisely

    $$F_{ij}(x) = K((x - \mu_{ij})/\sigma_{ij})$$

-   EVEN: identical distribution up to shifting

    $$F_{ij}(x) = H(x - \mu_{ij})$$

    Not necessarily worse than C-PROP

---

Comparison
----------

![image](lec05.files/fig23.png)

---

Three Solving Methods in General
--------------------------------

-   Binary search based
    -   Local convergence is slow.
-   Cycle based
    -   Idea: if a solution is infeasible, there exists a negative cycle
        which can always be "zero-out" with minimum effort (proof of
        optimality)
-   ğŸ›¤ï¸ Path based
    -   Idea: if a solution is feasible, there exists a (shortest) path
        from where we can always improve the solution.

---

Parametric Shortest Path Algorithms
-----------------------------------

-   Lawler's algorithm (binary search)
-   Howard's algorithm (based on cycle cancellation)
-   Hybrid method
-   Improved Howard's algorithm
-   Input:
    -   Interval [Î²min, Î²max] that includes Î²\*
    -   Tol: tolerance
    -   G(V, E): timing graph
-   Output:
    -   Optimal Î²* and its corresponding critical cycle C

---

Lawler's Algorithm
------------------

.column-2.column-norule.font-sm.mb-xs[

```uml
@startuml
 while ((Î²max - Î²min) > tol)
    : Î² := (Î²min + Î²max) / 2;
    if (a neg. cycle C under Î² exists) then
       : Î²max := Î²;
    else
       : Î²min := Î²;
    endif
 endwhile
 : Î²* := Î²;
@enduml
```

![image](http://www.plantuml.com/plantuml/svg/JOuz3i8m38NtdEAD2GYGEXR1macgrcqjfKOYHYstnswMUl7mlRzrvao8KPTkmmMwi2GyeU-S0knQADe7eWESuRA46vhxJdb4x20qNT7_UWjwuIi3VSn46nSj2JgJxDeQvZMMfzLFkT0HMiS1oi1ZyBVwoE2AK-L_)

]

---

Howard's Algorithm
------------------

.column-2.column-norule.font-sm.mb-xs[

```uml
@startuml
 : Î² := Î²max;
 while (a neg. cycle C under Î² exists)
    : find Î²' such that
      sum{(i,j) in C | fij(Î²')} = 0;
    : Î² := Î²';
 endwhile
 : Î²* := Î²;
@enduml
```

![image](http://www.plantuml.com/plantuml/svg/BOsn3W8X44Hxlc8wm1XZ3RdABo6mobuy2jcBPzH_TqMdUoypcG11c21BsgB1lVALu18QNGx8ZwnqmjeAtRH76tVfta0JSEPM81PzpHLIammFvUNfU3zxSDFnIukp4-lVc72C__7lr2fIA-FLVErkwFW1)

]

---

Hybrid Method
-------------

.column-2.column-norule.font-sm.mb-xs[

```uml
@startuml
 while ((Î²max - Î²min) > tol)
    : Î² := (Î²min + Î²max) / 2;
    if (a neg. cycle C under Î² exists) then
       : find Î²' such that
         sum{(i,j) in C | fij(Î²')} = 0;
       : Î² := Î²';
       : Î²max := Î²;
    else
       : Î²min := Î²;
    endif
 endwhile
 : Î²* := Î²;
@enduml
```

![image](http://www.plantuml.com/plantuml/svg/JO_D2eD038JlFiKS17VxJu-AlVWaecjTqHMw4Irjtxt9Igcv1EQRJ9AvjRs1KZIK2uwWmJgD6sZiTGIk58GqXnA0FSIcSSOr2zGsK2MSkPzGFIiEAZ2vsZnuo2pMazUWrhZW3M6DTJLYIcBugMePbeGV1Ml3Izb3fy7B2hpPtYbAz0SvBja_9Pn4oLQHyqLSDTDxiuKSju6kjaqaRPRd8t7iLlu5)

]

---

Improved Howard's Algorithm
---------------------------

.column-2.column-norule.font-sm.mb-xs[

```uml
@startuml
 : Î² := (Î²min + Î²max) / 2;
 while (no neg. cycle under Î²)
    : Î²min := Î²;
    : Î² := (Î²min + Î²max) / 2;
 endwhile
 while (a neg. cycle C under Î² exists)
    : find Î²' such that
      sum{(i,j) in C | fij(Î²')} = 0;
    : Î² := Î²';
 endwhile
 : Î²* := Î²;
@enduml
```

![image](http://www.plantuml.com/plantuml/svg/TOx13i8W44Jl_Ogv0MhKUAJfgLz208L6CB7RMAF-kniCnXxSsqnstem6GNUGb6B66fJChB33eMrm2_7i8VC5sP-si7VBSihENq6g0Pz6YN6Uschye_di2l3BDR_OleBXvpZIMFd7c1r8O9ni00L3nGVhz91nCoXmKOydFmwIX7gXmtwnXSIYdDtLP_0R)

]

---

count: false
class: nord-dark, middle, center

.pull-left[

# Q & A ğŸ¤

]
.pull-right[

![image](figs/questions-and-answers.svg)

]

---

Backup
------

``` {.terminal}
> pandoc -t beamer lec05b.md beamer.yaml -o slide05b.pdf
```

    </textarea>
    <script src="../js/remark.min.js"></script>
    <script src="../katex/katex.min.js" type="text/javascript"></script>
    <script
      src="../katex/contrib/auto-render.min.js"
      type="text/javascript"
    ></script>
    <script type="text/javascript">
      renderMathInElement(document.getElementById("source"), {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "$", right: "$", display: false },
        ],
      });
      var slideshow = remark.create({
        ratio: "4:3", // çª—å£æ¯”ä¾‹
        // å¯é€‰ï¼šarta, ascetic, dark, default, far, github, googlecode, idea,
        // ir-black, magula, monokai, rainbow, solarized-dark, solarized-light,
        // sunburst, tomorrow, tomorrow-night-blue, tomorrow-night-bright,
        // tomorrow-night, tomorrow-night-eighties, vs, zenburn.
        highlightStyle: "tomorrow-night-eighties",
        highlightLines: true,
        countIncrementalSlides: false, // å¢é‡å†…å®¹æ˜¯å¦ç®—ä¸€é¡µ
        // slideNumberFormat: "", // è‹¥å°†æ­¤å‚æ•°è®¾ç½®ä¸º ""ï¼Œå°†ä¸æ˜¾ç¤ºé¡µç 
        navigation: {
          scroll: false, // æ˜¯å¦å…è®¸ä½¿ç”¨é¼ æ ‡æ»šè½®ç¿»é¡µ
          touch: true, // ï¼ˆå¦‚æœæ˜¯è§¦æ‘¸å±ï¼‰æ˜¯å¦å…è®¸ç‚¹å‡»å±å¹•å·¦è¾¹æˆ–å³è¾¹å‰åç¿»é¡µ
          click: false, // æ˜¯å¦å…è®¸é¼ æ ‡ç‚¹å‡»å±å¹•å·¦è¾¹æˆ–å³è¾¹å‰åç¿»é¡µ
        },
      });
    </script>
  </body>
</html>
