\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[10pt,ignorenonframetext,serif,onlymath]{beamer}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\beamertemplatenavigationsymbolsempty
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Geometry, Algebra and Computation (II)},
            pdfauthor={Wai-Shing Luk},
            colorlinks=true,
            linkcolor=Maroon,
            citecolor=Blue,
            urlcolor=Blue,
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\newif\ifbibliography
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
% Prevent slide breaks in the middle of a paragraph:
\widowpenalties 1 10000
\raggedbottom
\setbeamertemplate{part page}{
\centering
\begin{beamercolorbox}[sep=16pt,center]{part title}
  \usebeamerfont{part title}\insertpart\par
\end{beamercolorbox}
}
\setbeamertemplate{section page}{
\centering
\begin{beamercolorbox}[sep=12pt,center]{part title}
  \usebeamerfont{section title}\insertsection\par
\end{beamercolorbox}
}
\setbeamertemplate{subsection page}{
\centering
\begin{beamercolorbox}[sep=8pt,center]{part title}
  \usebeamerfont{subsection title}\insertsubsection\par
\end{beamercolorbox}
}
\AtBeginPart{
  \frame{\partpage}
}
\AtBeginSection{
  \ifbibliography
  \else
    \frame{\sectionpage}
  \fi
}
\AtBeginSubsection{
  \frame{\subsectionpage}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usetheme{default}
\usepackage{tikz,pgf,pgfplots}
\usetikzlibrary{arrows}
\definecolor{qqqqff}{rgb}{0.,0.,1.}
\newcommand{\columnsbegin}{\begin{columns}}
\newcommand{\columnsend}{\end{columns}}
\newcommand{\col}[1]{\column{#1}}
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\title{Geometry, Algebra and Computation (II)}
\author{Wai-Shing Luk}
\providecommand{\institute}[1]{}
\institute{Fudan University}
\date{\today}

\begin{document}
\frame{\titlepage}

\begin{frame}
\tableofcontents[hideallsubsections]
\end{frame}
\hypertarget{sec:cayley-klein-geometry}{%
\section{Cayley-Klein geometry}\label{sec:cayley-klein-geometry}}

\begin{frame}{Key points}
\protect\hypertarget{sec:key-points}{}

\begin{itemize}
\item
  Gravity/electromagnetic force between two objects is inversely
  proportional to the square of their distance.
\item
  Distance and angle may be powerful for oriented measures. But
  quadrance and spread are more energy saving for non-oriented measures.
\item
  Euclidean Geometry is a degenerate case.
\end{itemize}

\end{frame}

\begin{frame}{Cayley-Klein Geometry}
\protect\hypertarget{sec:cayley-klein-geometry-1}{}

\begin{itemize}
\item
  Projective geometry can further be categorized by a specific polarity.
\item
  Except degenerate cases, \((A^\perp)^\perp = A\) and
  \((a^\perp)^\perp = a\)
\item
  A fundamental cone \(\mathcal{F} = (\mathbf{A}, \mathbf{B})\) is
  defined by a pole/polar pair such that
  \([A^\perp] = \mathbf{A} \cdot [A]\) and
  \([a^\perp] = \mathbf{B} \cdot [a]\).
\item
  To visualize the Cayley-Klein Geometry, we may project the objects to
  the 2D plane.
\item
  In hyperbolic geometry, the projection of the fundamental conic to the
  2D plane is a unit circle, which is called \emph{null circle}. The
  distance and angle measures could be negative outside the null circle.
\item
  We may consider Euclidean geometry as a hyperbolic geometry where the
  null circle is expanded toward the infinity.
\item
  In this section, we use the vector notation \(p = [A]\) and
  \(l = [a]\).
\end{itemize}

\end{frame}

\begin{frame}{Fundamental Cone with a pole and polar}
\protect\hypertarget{sec:fundamental-cone-with-a-pole-and-polar}{}

\begin{figure}[hp]
\centering
\input{figs/F.tikz}
\caption{Fudanmental Cone with a pole and polar}
\label{fig:F}
\end{figure}

\end{frame}

\begin{frame}{Examples}
\protect\hypertarget{sec:examples}{}

Let \(p = [x, y, z]\) and \(l = [a, b, c]\)

\begin{columns}
\column{.5\textwidth}

\begin{itemize}
\tightlist
\item
  Hyperbolic geometry:

  \begin{itemize}
  \tightlist
  \item
    \(\mathbf{A} \cdot p \equiv [x, y, -z]\)
  \item
    \(\mathbf{B} \cdot l \equiv [a, b, -c]\)
  \end{itemize}
\item
  Elliptic geometry:

  \begin{itemize}
  \tightlist
  \item
    \(\mathbf{A} \cdot p \equiv [x, y, z]\)
  \item
    \(\mathbf{B} \cdot l \equiv [a, b, c]\)
  \end{itemize}
\end{itemize}

\column{.5\textwidth}

\begin{itemize}
\tightlist
\item
  Euclidean geometry (degenerate conic):

  \begin{itemize}
  \tightlist
  \item
    \(\mathbf{A} \cdot p \equiv [0, 0, z]\)
  \item
    \(\mathbf{B} \cdot l \equiv [a, b, 0]\)
  \end{itemize}
\item
  psuedo-Euclidean geometry (degenerate conic):

  \begin{itemize}
  \tightlist
  \item
    \(\mathbf{A} \cdot p \equiv [0, 0, z]\)
  \item
    \(\mathbf{B} \cdot l \equiv [a, -b, 0]\)
  \end{itemize}
\end{itemize}

\end{columns}

\end{frame}

\begin{frame}{Examples (cont’d)}
\protect\hypertarget{sec:examples-contd}{}

\begin{itemize}
\tightlist
\item
  Perspective view of Euclidean geometry (degenerate conic):

  \begin{itemize}
  \tightlist
  \item
    Let \(l\) be the line of infinity.
  \item
    Let \(p\) and \(q\) are two complex conjugate points on \(l\). Then
  \item
    \(\mathbf{A} \equiv l \cdot l^{T}\) (outer product)
  \item
    \(\mathbf{B} \equiv p \cdot q^{T} + q \cdot p^{T}\)
  \end{itemize}
\end{itemize}

\end{frame}

\begin{frame}{Orthogonality}
\protect\hypertarget{sec:orthogonality}{}

\begin{itemize}
\item
  A line \(l\) is said to be perpendicular to line \(m\) if \(l^\perp\)
  lies on \(m\), i.e., \(m^\mathsf{T} \mathbf{B} l = 0\).
\item
  To find a perpendicular line of \(l\) that passes through \(p\), join
  \(p\) to the pole of \(l\), i.e., join(\(p, l^\perp\)). We call this
  the \emph{altitude} line of \(l\).
\item
  For duality, a point \(p\) is said to be perpendicular to point \(q\)
  if \(q^\mathsf{T} \mathbf{A} p = 0\).
\item
  The altitude point can be defined similarly.
\item
  Note that Euclidean geometry does not have the concept of the
  perpendicular point because every \(p^\perp\) is the line of infinity.
\end{itemize}

\end{frame}

\begin{frame}{Orthocenter of triangle}
\protect\hypertarget{sec:orthocenter-of-triangle}{}

\begin{itemize}
\item
  Theorem 1 (Orthocenter and ortholine). The altitude lines of a
  non-dual triangle meet at a unique point \(O\), called the
  \emph{orthocenter} of the triangle.
\item
  Although there is “center” in the name, orthocenter could be outside a
  triangle.
\item
  Theorem 2. If the orthocenter of triangle \(\{ABC\}\) is \(O\), then
  the orthocenter of triangle \(\{OBC\}\) is \(A\).
\end{itemize}

\end{frame}

\begin{frame}{An instance of orthocenter theorem}
\protect\hypertarget{sec:an-instance-of-orthocenter-theorem}{}

\begin{figure}[hp]
\centering
\input{figs/orthocenter.tikz}
\caption{An instance of orthocenter theorem}
\label{fig:orthocenter}
\end{figure}

\end{frame}

\begin{frame}{An instance of Theorem 2}
\protect\hypertarget{sec:an-instance-of-theorem-2}{}

\begin{figure}[hp]
\centering
\input{figs/orthocenter2.tikz}
\caption{An instance of An instance of Theorem 2}
\label{fig:orthocenter2}
\end{figure}

\end{frame}

\begin{frame}{Involution}
\protect\hypertarget{sec:involution}{}

\begin{itemize}
\item
  Involutions are closely related to geometric reflections.
\item
  The defining property of an involution \(\tau\) is that
  \(\tau(\tau(p)) = p\) for every point \(p\).
\item
  Theorem: Let \(\tau\) be an involution. Then

  \begin{enumerate}
  [1.]
  \tightlist
  \item
    there is a line \(m\) with \(\tau(p) = p\) for every poiny \(p\)
    incident with \(m\).
  \item
    there is a point \(o\) with \(\tau(l) = l\) for every line \(l\)
    incident with \(o\).
  \end{enumerate}
\item
  We call the line \(m\) a \emph{mirror} and the point \(o\) the
  \emph{center} of the involution.
\item
  If \(o\) is at the line of infinity (Euclidean Geometry), then we get
  an undistorted Euclidean line reflection in \(m\).
\item
  If we choose \(o = m^\perp\), then we keep the fundamental cone
  invariant.
\end{itemize}

\end{frame}

\begin{frame}{Involution (cont’d)}
\protect\hypertarget{sec:involution-contd}{}

\begin{itemize}
\item
  Theorem: The point transformation matrix \(T\) of a projective
  involution \(\tau\) with center \(o\) and mirror \(m\) is given by
  \[ (o^\mathsf{T} m) \mathrm{I} - 2 o m^\mathsf{T}\]
\item
  In other words, \(T\cdot p\) =
  \((o^\mathsf{T} m) p - 2 (m^\mathsf{T} p) o\).
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Python Code}
\protect\hypertarget{sec:python-code}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ proj_geom }\ImportTok{import} \OperatorTok{*}

\KeywordTok{def}\NormalTok{ is_perpendicular(l, m):}
    \ControlFlowTok{return}\NormalTok{ m.incident(dual(l))}

\KeywordTok{def}\NormalTok{ altitude(p, l):}
    \ControlFlowTok{return}\NormalTok{ p }\OperatorTok{*}\NormalTok{ dual(l)}

\KeywordTok{def}\NormalTok{ orthocenter(a1, a2, a3):}
\NormalTok{    t1 }\OperatorTok{=}\NormalTok{ altitude(a1, a2}\OperatorTok{*}\NormalTok{a3)}
\NormalTok{    t2 }\OperatorTok{=}\NormalTok{ altitude(a2, a1}\OperatorTok{*}\NormalTok{a3)}
    \ControlFlowTok{return}\NormalTok{ t1}\OperatorTok{*}\NormalTok{t2}

\KeywordTok{class}\NormalTok{ reflect:}
    \KeywordTok{def} \FunctionTok{__init__}\NormalTok{(}\VariableTok{self}\NormalTok{, m, O):}
        \VariableTok{self}\NormalTok{.m }\OperatorTok{=}\NormalTok{ m}
        \VariableTok{self}\NormalTok{.O }\OperatorTok{=}\NormalTok{ O}
        \VariableTok{self}\NormalTok{.c }\OperatorTok{=}\NormalTok{ dot(m, O)}

    \KeywordTok{def} \FunctionTok{__call__}\NormalTok{(}\VariableTok{self}\NormalTok{, p):}
        \ControlFlowTok{return}\NormalTok{ pk_point(}\VariableTok{self}\NormalTok{.c, p, }\DecValTok{-2} \OperatorTok{*}\NormalTok{ dot(}\VariableTok{self}\NormalTok{.m, p), }\VariableTok{self}\NormalTok{.O)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\hypertarget{sec:basic-measurement}{%
\section{Basic measurement}\label{sec:basic-measurement}}

\begin{frame}{Quadrance and Spread for general cases}
\protect\hypertarget{sec:quadrance-and-spread-for-general-cases}{}

\begin{itemize}
\item
  Let \(\Omega(x) = x \cdot x^\perp\).
\item
  \(\Omega(A) = A \cdot A^\perp = [A]^\mathsf{T} \mathbf{A} [A]\).
\item
  \(\Omega(a) = a \cdot a^\perp = [a]^\mathsf{T} \mathbf{B} [a]\).
\item
  The \textbf{quadrance} \(q(A, B)\) between points \(A\) and \(B\) is:
  \[q(A, B) \equiv \Omega(AB) / \Omega(A) \Omega(B)\]
\item
  The \textbf{spread} \(s(l, m)\) between lines \(l\) and \(m\) is
  \[s(l, m) \equiv  \Omega(lm) / \Omega(l) \Omega(m)\]
\item
  Note: they are invariant of any projective transformations.
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Python Code}
\protect\hypertarget{sec:python-code-1}{}

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{from}\NormalTok{ fractions }\ImportTok{import} \OperatorTok{*}

\KeywordTok{def}\NormalTok{ omega(l):}
    \ControlFlowTok{return}\NormalTok{ dot(l, dual(l))}

\KeywordTok{def}\NormalTok{ measure(a1, a2):}
\NormalTok{    omg }\OperatorTok{=}\NormalTok{ omega(a1}\OperatorTok{*}\NormalTok{a2)}
    \ControlFlowTok{if} \BuiltInTok{isinstance}\NormalTok{(omg, }\BuiltInTok{int}\NormalTok{):}
        \ControlFlowTok{return}\NormalTok{ Fraction(omg, omega(a1) }\OperatorTok{*}\NormalTok{ omega(a2))}
    \ControlFlowTok{else}\NormalTok{:}
        \ControlFlowTok{return}\NormalTok{ omg }\OperatorTok{/}\NormalTok{ (omega(a1) }\OperatorTok{*}\NormalTok{ omega(a2))}

\KeywordTok{def}\NormalTok{ quadrance(a1, a2):}
    \ControlFlowTok{return}\NormalTok{ measure(a1, a2)}

\KeywordTok{def}\NormalTok{ spread(l1, l2):}
    \ControlFlowTok{return}\NormalTok{ measure(l1, l2)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}{Relation with Traditional Distance and Angle}
\protect\hypertarget{sec:relation-with-traditional-distance-and-angle}{}

\begin{itemize}
\tightlist
\item
  Hyperbolic:

  \begin{itemize}
  \tightlist
  \item
    \(q(A, B ) = \sinh^2(d(A, B))\)
  \item
    \(s(l, m ) = \sin^2(\theta(l, m))\)
  \end{itemize}
\item
  Elliptic:

  \begin{itemize}
  \tightlist
  \item
    \(q(A, B ) = \sin^2(d(A, B))\)
  \item
    \(s(l, m ) = \sin^2(\theta(l, m))\)
  \end{itemize}
\item
  Euclidean:

  \begin{itemize}
  \tightlist
  \item
    \(q(A, B ) = d^2(A, B)\)
  \item
    \(s(l, m ) = \sin^2(\theta(l, m))\)
  \end{itemize}
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Measure dispersion among points on a unit sphere}
\protect\hypertarget{sec:measure-dispersion-among-points-on-a-unit-sphere}{}

\begin{columns}
\column{.5\textwidth}

Usual way:

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nsimplex, n }\OperatorTok{=}\NormalTok{ K.shape}
\NormalTok{maxd }\OperatorTok{=} \DecValTok{0}
\NormalTok{mind }\OperatorTok{=} \DecValTok{1000}
\ControlFlowTok{for}\NormalTok{ k }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(nsimplex):}
\NormalTok{  p }\OperatorTok{=}\NormalTok{ X[K[k,:],:]}
  \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(n}\DecValTok{-1}\NormalTok{):}
    \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(i}\OperatorTok{+}\DecValTok{1}\NormalTok{, n):}
\NormalTok{      dot }\OperatorTok{=}\NormalTok{ dot(p[i,:], p[j,:])}
\OperatorTok{*}\NormalTok{     q }\OperatorTok{=} \FloatTok{1.0} \OperatorTok{-}\NormalTok{ dot}\OperatorTok{*}\NormalTok{dot}
\OperatorTok{*}\NormalTok{     d }\OperatorTok{=}\NormalTok{ arcsin(sqrt(q))}
      \ControlFlowTok{if}\NormalTok{ maxd }\OperatorTok{<}\NormalTok{ d:}
\NormalTok{        maxd }\OperatorTok{=}\NormalTok{ d}
      \ControlFlowTok{if}\NormalTok{ mind }\OperatorTok{>}\NormalTok{ d:}
\NormalTok{        mind }\OperatorTok{=}\NormalTok{ d}
\OperatorTok{*}\NormalTok{dis }\OperatorTok{=}\NormalTok{ maxd }\OperatorTok{-}\NormalTok{ mind}
\end{Highlighting}
\end{Shaded}

\column{.5\textwidth}

Better way:

\scriptsize

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nsimplex, n }\OperatorTok{=}\NormalTok{ K.shape}
\NormalTok{maxd }\OperatorTok{=} \DecValTok{0}
\NormalTok{mind }\OperatorTok{=} \DecValTok{1000}
\ControlFlowTok{for}\NormalTok{ k }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(nsimplex):}
\NormalTok{  p }\OperatorTok{=}\NormalTok{ X[K[k,:],:]}
  \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(n}\DecValTok{-1}\NormalTok{):}
    \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(i}\OperatorTok{+}\DecValTok{1}\NormalTok{, n):}
\NormalTok{      dot }\OperatorTok{=}\NormalTok{ dot(p[i,:], p[j,:])}

\OperatorTok{*}\NormalTok{     q }\OperatorTok{=} \FloatTok{1.0} \OperatorTok{-}\NormalTok{ dot}\OperatorTok{*}\NormalTok{dot}
      \ControlFlowTok{if}\NormalTok{ maxq }\OperatorTok{<}\NormalTok{ q:}
\NormalTok{        maxq }\OperatorTok{=}\NormalTok{ q}
      \ControlFlowTok{if}\NormalTok{ minq }\OperatorTok{>}\NormalTok{ q:}
\NormalTok{        minq }\OperatorTok{=}\NormalTok{ q}
\OperatorTok{*}\NormalTok{dis }\OperatorTok{=}\NormalTok{ arcsin(sqrt(maxq)) }\OperatorTok{\textbackslash{}}
\OperatorTok{*}      \OperatorTok{-}\NormalTok{ arcsin(sqrt(minq))}
\end{Highlighting}
\end{Shaded}

\end{columns}

\end{frame}

\begin{frame}{Spread law and Thales Theorem}
\protect\hypertarget{sec:spread-law-and-thales-theorem}{}

\begin{itemize}
\item
  Spread Law \[\color{Green}{q_1/s_1 = q_2/s_2 = q_3/s_3}.\]
\item
  (Compare with the sine law in Euclidean Geometry):
  \[\color{Red}{d_1/\sin \theta_1 = d_2/\sin \theta_2 = d_3/\sin \theta_3}.\]
\item
  Theorem (Thales): Suppose that \(\{a_1 a_2 a_3\}\) is a right triangle
  with \(s_3 = 1\). Then
  \[s_1 = q_1 / q_3 \quad \text{and} \quad s_2 = q_2 / q_3\]
\item
  Note: in some geometries, two lines are perpendicular does not imply
  they have a right angle (\(s = 1\)).
\end{itemize}

\end{frame}

\begin{frame}{Triangle proportions}
\protect\hypertarget{sec:triangle-proportions}{}

\begin{itemize}
\tightlist
\item
  Theorem (Triangle proportions): Suppose that \(d\) is a point lying on
  the line \(a_1 a_2\). Define the quadrances \(r_1 \equiv q(a_1, d)\)
  and \(r_1 \equiv q(a_2, d)\), and the spreads
  \(R_1 \equiv s(a_3 a_1, a_3 d)\) and \(R_2 \equiv s(a_3 a_2, a_3 d)\).
  Then \[R_1/R_2 = (s_1/s_2)(r_1/r_2) = (q_1/q_2)(r_1/r_2).\]
\end{itemize}

\end{frame}

\begin{frame}{Midpoint and Angle Bisector}
\protect\hypertarget{sec:midpoint-and-angle-bisector}{}

\begin{itemize}
\tightlist
\item
  There are two angle bisectors for two lines.
\item
  There are two midpoints for two points also in general geometries.
\item
  Let \(r\) be the midpint of \(p\) and \(q\).
\item
  Then \(r\) = \(\sqrt{\Phi(p)} q \pm \sqrt{\Phi(q)} p\).
\item
  Let \(b\) be the angle bisector of \(l\) and \(m\).
\item
  Then \(b\) = \(\sqrt{\Phi(m)} l \pm \sqrt{\Phi(l)} m\).
\item
  Note:

  \begin{itemize}
  \tightlist
  \item
    The midpoint could be irrational in general.
  \item
    The midpoint could even be complex, even the two points are real.
  \item
    Two angle bisectors are perpendicular.
  \item
    In Euclidean geometry, another midpoint is at the line of infinity.
  \end{itemize}
\end{itemize}

\end{frame}

\begin{frame}{Midpoint in Euclidean geometry}
\protect\hypertarget{sec:midpoint-in-euclidean-geometry}{}
 
\begin{itemize}
\tightlist
\item
  Let \(l\) be the line of infinity.
\item
  \(\mathbf{A} \equiv l \cdot l^{T}\)
\item
  \(\Phi(p)\) = \(p^\mathsf{T} \mathbf{A} p\) = \((p^\mathsf{T} l)^2\).
\item
  Then, the midpoint \(r\) =
  \((q^\mathsf{T} l) p \pm (p^\mathsf{T} l) q\).
\item
  One midpoint \((q^\mathsf{T} l) p - (p^\mathsf{T} l) q\) in fact lies
  on \(l\).
\end{itemize}

\end{frame}

\begin{frame}{Constructing angle bisectors using a conic}
\protect\hypertarget{sec:constructing-angle-bisectors-using-a-conic}{}

\begin{enumerate}
[1.]
\tightlist
\item
  For each line construct the two tangents \((t_f^1, t_f^2)\) and
  \((t_g^1, t_g^2)\) of its intersection points with the fundamental
  conic to that conic.
\item
  The following lines are the two angle bisectors:

  \begin{itemize}
  \tightlist
  \item
    join(meet(\(t_f^1, t_g^1\)), meet(\(t_f^2, t_g^2\)))
  \item
    join(meet(\(t_f^1, t_g^2\)), meet(\(t_f^2, t_g^1\)))
  \end{itemize}
\end{enumerate}

\begin{quote}
Remark: the tangents in elliptic geometry have complex coordinates.
However, the angle bisectors are real objects again.
\end{quote}

\end{frame}

\begin{frame}{Constructing a pair of angle bisectors}
\protect\hypertarget{sec:constructing-a-pair-of-angle-bisectors}{}

\begin{figure}[hp]
\centering
\input{figs/bisector.tikz}
\caption{Constructing a pair of angle bisectors}
\label{fig:bisector}
\end{figure}

\end{frame}

\begin{frame}{Angle Bisector Theorem}
\protect\hypertarget{sec:angle-bisector-theorem}{}

\begin{itemize}
\item
  Let \(a\), \(b\), \(c\) be three lines such that none of them tangents
  to the fundamental conic.
\item
  Then one set of angle bisector \(m^1_{ab}, m^1_{bc}, m^1_{ac}\) are
  concurrent.
\item
  Furthermore, the points meet(\(m^2_{ab}, c\)), meet(\(m^2_{bc}, a\)),
  meet(\(m^2_{ac}, b\)) are collinear.
\end{itemize}

\end{frame}

\begin{frame}{An instance of complete angle bisector theorem}
\protect\hypertarget{sec:an-instance-of-complete-angle-bisector-theorem}{}

\begin{figure}[hp]
\centering
\input{figs/bisectortheorem.tikz}
\caption{An instance of complete angle bisector theorem}
\label{fig:bisectortheorem}
\end{figure}

\end{frame}

\begin{frame}{Midpoint theorem}
\protect\hypertarget{sec:midpoint-theorem}{}

\begin{itemize}
\item
  Let \(p\), \(q\), \(r\) be three points such that none of them lies on
  the fundamental conic.
\item
  Then one set of midpoints \(m^1_{pq}\)\emph{, \(m^1_{qr}\)},
  \(m^1_{pr}\) are collinear.
\item
  Furthermore, the lines join(\(m^2_{pq}, r\)\emph{),
  join(\(m^2_{qr}, p\)}), join(\(m^2_{pr}, q\)) meet at a point.
\end{itemize}

\end{frame}

\begin{frame}[fragile]{backup}
\protect\hypertarget{sec:backup}{}

\begin{verbatim}
> http://melpon.org/wandbox/permlink/Rsn3c3AW7Ud8E1qX
\end{verbatim}

\end{frame}

\end{document}
